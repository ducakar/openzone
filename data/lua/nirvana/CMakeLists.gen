#!/bin/sh

printf '' > CMakeLists.txt

ls *.lua &> /dev/null || exit 0

for script in *.lua; do
  baseName=`basename $script .lua`
  echo "add_custom_target( nirvana_$baseName ALL DEPENDS $baseName.luac )" >> CMakeLists.txt
  echo "add_custom_command( OUTPUT $baseName.luac" >> CMakeLists.txt
  echo "                    MAIN_DEPENDENCY $baseName.lua" >> CMakeLists.txt
  echo "                    COMMAND luac -o $baseName.luac $baseName.lua )" >> CMakeLists.txt
done
